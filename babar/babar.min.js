var babar,$b; babar=$b={options:{title:"babar.js"},constants:{hash_regexp:/^#!\/?/,yield_id:"babar-yield",error_class:"babar-error",partial_prefix:"babar-partial-",page_prefix:"babar-page-"},hash:{change:function(){var a;a=location.hash;a=a.match($b.constants.hash_regexp)?a.replace($b.constants.hash_regexp,"").replace(/\/+$/,""):"";""==a&&(window.location.hash="#!/");$b.render.path(a)},watch:function(){$b.hash.change();$(window).hashchange($b.hash.change)}},js:function(a){$b.options=a;$("head").prepend("<title>"+$b.options.title+ "</title><link href='babar/babar.css' rel='stylesheet'><link href='app/style.css' rel='stylesheet'>");$b.hash.watch()},get:function(a,d){var c,b;c="";b="app/";a.match(/page/i)&&(b+="pages/");a.match(/layout/i)&&(b+="layouts/");a.match(/partial/i)&&(b+="pages/_");b+=d+".html";c="<div class='"+$b.constants.error_class+"'>Resource not found: "+b+"</div>";$.ajax({async:!1,url:b,success:function(a){c=a}});return c},partials:{find:function(){var a;a=[];$("*[class*="+$b.constants.partial_prefix+"]").each(function(d, c){var b;b=$(c).attr("class").replace(/\s+/g," ").split(" ");$.each(b,function(b,d){var e;d.match($b.constants.partial_prefix)&&(e=d.replace(/_/g,"/").replace(eval("/^"+$b.constants.partial_prefix+"/"),"").split(" ")[0],console.log([c,e]),a.push([c,e]))})});return a},render:function(){var a;a=$b.partials.find();$.each(a,function(a,c){var b,f;b=c[0];f=c[1];$(b).append($b.get("partial",f))})}},render:{page_and_layout:function(a,d){var c,b;a||(a="index");d||(d="default");c=$b.get("page",a);b=$b.get("layout", d);$("body").html(b);$("#"+$b.constants.yield_id).html(c);$b.partials.render()},path:function(a){a=a.replace(/(^\/|\/$)/,"");console.log(a);($b.constants.page_prefix+a.replace(/\//g,"_")).slice(-1);return $b.render.page_and_layout(a)}}};